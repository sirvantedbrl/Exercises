---
title: "Hava Kalitesi Veri Analizi"
output:
  html_document:
    df_print: paged
---

T.C. Çevre Şehircilik ve İklim Değişikliği bakanlığının ülke genelinde yaptığı hava kalitesi
ölçümleri [https://sim.csb.gov.tr/Services/AirQuality](https://sim.csb.gov.tr/Services/AirQuality) adresinde bulunan web uygulamasında istasyon bazında görsellenebilmektedir. 

Ham veriler ise [https://sim.csb.gov.tr/STN/STN_Report/StationDataDownloadNew](https://sim.csb.gov.tr/STN/STN_Report/StationDataDownloadNew) adresinden *Excel* formatında indirlebilmektedir. 

## Veri ithali

İstanbul Arnavutköy'e ait olan saatlik hava kalitesi parametrelerini Excel formatında eylül ayı için indirdim.

```{r warning=FALSE}
library(readxl)
havaK <- readxl::read_excel("Veri Detayları3_23_2024, 5_41_57 PM.xlsx", skip = 1, col_names = c("Tarih", "istanbul-Kartal", "PM2.5", "SO2", "CO","NO2","NOX","NO","O3"))
head(havaK, 10)
```

## Veri Kalite Kontrolü

### Zaman sütunu
Zaman değerlerini içeren sütunun isminin **Time** olması
```{r}
# tarih sütunun adını time olarak değiştirme 
names(havaK)[1] <- "Time"
```


*havaK$Time* adlı değişkendeki bütün verilerin **POSIXct** tipinde olmasını sağladım 

```{r}
# havaK$Time sütununu POSIXct türüne dönüştürme
havaK$Time <- as.POSIXct(havaK$Time)
```

*Time* sütunu dışındaki bütün sütunların tipinin **numeric** olmasını sağladım.

```{r message=FALSE, warning=FALSE}
library(dplyr)

# Tüm sütunların tipini numeric yapma (ilk sütun hariç)
havaK <- havaK %>%
  mutate(across(-1, ~as.numeric(gsub(",", ".", .))))
# İlk satırı çıkartma
havaK <- havaK[-1, ]
head(havaK, 10)
```

## Egzersiz 3 - Veri Görselleme

Dygraphs paketini kullanarak PM2.5 ve NOX değerlerinin zaman serisi grafiğini oluşturdum.




```{r warning=FALSE}
# dygraphs paketini yükleyin
library(dygraphs)

# Hava kalitesi verilerini zaman serisi nesneye dönüştürme
havaK_ts <- xts::xts(havaK[, -1], order.by = havaK$Time)

# İki farklı parametre için ayrı ayrı zaman serileri oluşturma
pm25 <- havaK_ts$PM2.5
nox <- havaK_ts$NOX

# dygraph grafiğini oluşturma
dygraph(cbind(pm25, nox), main = "PM2.5 ve NOX Değerlerinin Zaman Serisi Grafiği") %>%
  dyAxis("y", label = "PM2.5", axisLabelColor = "blue") %>%
  dyAxis("y2", label = "NOX", axisLabelColor = "red") %>%
  dyOptions(colors = c("blue", "red")) %>%
  dySeries("NOX", axis = "y2")
```
